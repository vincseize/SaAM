(function(f){var i=new Array(),n=new Array(),d=function(){},g=0;var b={splashVPos:"35%",loaderVPos:"75%",splashID:"#jpreContent",showSplash:true,showPercentage:true,autoClose:true,closeBtnText:"Start!",onetimeLoad:false,debugMode:false,splashFunction:function(){}};var l=function(){if(b.onetimeLoad){var q=document.cookie.split("; ");for(var p=0,r;(r=q[p]&&q[p].split("="));p++){if((r.shift())==="jpreLoader"){return(r.join("="))}}return false}else{return false}};var o=function(p){if(b.onetimeLoad){var r=new Date();r.setDate(r.getDate()+p);var q=((p==null)?"":"expires="+r.toUTCString());document.cookie="jpreLoader=loaded; "+q}};var k=function(){jOverlay=f("<div></div>").attr("id","jpreOverlay").css({position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:9999999}).appendTo("body");if(b.showSplash){jContent=f("<div></div>").attr("id","jpreSlide").appendTo(jOverlay);var p=f(window).width()-f(jContent).width();f(jContent).css({position:"absolute",top:b.splashVPos,left:Math.round((50/f(window).width())*p)+"%"});f(jContent).html(f(b.splashID).wrap("<div/>").parent().html());f(b.splashID).remove();b.splashFunction()}jLoader=f("<div></div>").attr("id","jpreLoader").appendTo(jOverlay);var q=f(window).width()-f(jLoader).width();f(jLoader).css({position:"absolute",top:b.loaderVPos,left:Math.round((50/f(window).width())*q)+"%"});jBar=f("<div></div>").attr("id","jpreBar").css({width:"0%",height:"100%"}).appendTo(jLoader);if(b.showPercentage){jPer=f("<div></div>").attr("id","jprePercentage").css({position:"relative",height:"100%"}).appendTo(jLoader).html("Loading...")}if(!b.autoclose){jButton=f("<div></div>").attr("id","jpreButton").on("click",function(){h()}).css({position:"relative",height:"100%"}).appendTo(jLoader).text(b.closeBtnText).hide()}};var c=function(p){f(p).find("*:not(script)").each(function(){var r="";if(f(this).css("background-image").indexOf("none")==-1){r=f(this).css("background-image");if(r.indexOf("url")!=-1){var q=r.match(/url\((.*?)\)/);r=q[1].replace(/\"/g,"")}}else{if(f(this).get(0).nodeName.toLowerCase()=="img"&&typeof(f(this).attr("src"))!="undefined"){r=f(this).attr("src")}}if(r.length>0){i.push(r)}})};var e=function(){for(var p=0;p<i.length;p++){if(j(i[p])){}}};var j=function(p){var q=new Image();f(q).load(function(){m()}).error(function(){n.push(f(this).attr("src"));m()}).attr("src",p)};var m=function(){g++;var p=Math.round((g/i.length)*100);f(jBar).stop().animate({width:p+"%"},500,"linear");if(b.showPercentage){f(jPer).text(p+"%")}if(g>=i.length){g=i.length;o();if(b.showPercentage){f(jPer).text("100%")}if(b.debugMode){var q=a()}f(jBar).stop().animate({width:"100%"},500,"linear",function(){if(b.autoClose){h()}else{f(jButton).fadeIn(1000)}})}};var h=function(){f(jOverlay).fadeOut(800,function(){f(jOverlay).remove();d()})};var a=function(){if(n.length>0){var q="ERROR - IMAGE FILES MISSING!!!\n\r";q+=n.length+" image files cound not be found. \n\r";q+="Please check your image paths and filenames:\n\r";for(var p=0;p<n.length;p++){q+="- "+n[p]+"\n\r"}return true}else{return false}};f.fn.jpreLoader=function(p,q){if(p){f.extend(b,p)}if(typeof q=="function"){d=q}f("body").css({display:"block"});return this.each(function(){if(!(l())){k();c(this);e()}else{f(b.splashID).remove();d()}})}})(jQuery);